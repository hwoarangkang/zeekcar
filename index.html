<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‡¹ğŸ‡¼ å°ç£è»Šæ¬¾éŠ·å”®æŸ¥è©¢å°å¹«æ‰‹</title>
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232563EB'%3E%3Cpath d='M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z'/%3E%3C/svg%3E">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            corePlugins: { preflight: false } // é˜²æ­¢èˆ‡ WordPress æ¨£å¼è¡çª
        }
    </script>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        #car-sales-app { font-family: 'Noto Sans TC', sans-serif; line-height: 1.5; }
        [v-cloak] { display: none; }
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }
        
        /* æ¨£å¼å¾®èª¿ */
        #car-sales-app button { border-style: solid; cursor: pointer; }
        #car-sales-app input, #car-sales-app select { border-style: solid; }
        .rank-badge { width: 1.5rem; height: 1.5rem; display: inline-flex; align-items: center; justify-content: center; border-radius: 9999px; font-size: 0.75rem; font-weight: bold; color: white; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

<div id="car-sales-app" v-cloak class="max-w-6xl mx-auto min-h-screen flex flex-col bg-gray-50">
    
    <header class="bg-white shadow-sm sticky top-0 z-20 border-b border-gray-200">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 text-white p-2 rounded-lg flex items-center justify-center w-10 h-10">
                    <i class="fas fa-car-side text-xl"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-gray-900 leading-tight m-0">å°ç£è»Šæ¬¾éŠ·å”®å°å¹«æ‰‹</h1>
                    <p class="text-xs text-gray-500 m-0">è³‡æ–™ä¾†æºï¼šç›£ç†æ‰€é ˜ç‰Œæ˜ç´° (2025å¹´ 10æœˆ æ›´æ–°)</p>
                </div>
            </div>
            
            <div class="flex bg-gray-100 p-1 rounded-lg">
                <button @click="currentView = 'dashboard'" :class="{'bg-white shadow text-blue-600': currentView === 'dashboard', 'text-gray-600 hover:bg-gray-200': currentView !== 'dashboard'}" class="px-4 py-2 rounded-md text-sm font-bold transition border-0">
                    <i class="fas fa-trophy mr-1"></i> æˆ°æ³
                </button>
                <button @click="currentView = 'ranking'" :class="{'bg-white shadow text-blue-600': currentView === 'ranking', 'text-gray-600 hover:bg-gray-200': currentView !== 'ranking'}" class="px-4 py-2 rounded-md text-sm font-bold transition border-0">
                    <i class="fas fa-list-ol mr-1"></i> æ¦œå–®
                </button>
                <button @click="currentView = 'trend'" :class="{'bg-white shadow text-blue-600': currentView === 'trend', 'text-gray-600 hover:bg-gray-200': currentView !== 'trend'}" class="px-4 py-2 rounded-md text-sm font-bold transition border-0">
                    <i class="fas fa-chart-line mr-1"></i> è¶¨å‹¢
                </button>
            </div>
        </div>
    </header>

    <main class="flex-1 container mx-auto px-4 py-6">
        
        <div v-if="currentView === 'dashboard'" class="space-y-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-800 m-0 flex items-center">
                    <i class="fas fa-crown text-yellow-500 mr-2"></i> æœ¬æœˆéŠ·å”®æˆ°å ±
                </h2>
                <div class="relative inline-block">
                    <select v-model="selectedMonth" class="appearance-none bg-white border border-gray-300 px-4 py-2 pr-8 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 font-bold text-gray-700 cursor-pointer">
                        <option v-for="m in sortedMonths" :value="m">{{ formatMonth(m) }}</option>
                    </select>
                    <i class="fas fa-chevron-down absolute right-3 top-3 text-gray-400 pointer-events-none"></i>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div v-for="battle in battlefields" :key="battle.title" class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition flex flex-col">
                    <div class="px-5 py-3 border-b border-gray-100 flex justify-between items-center" :class="battle.bgLight">
                        <div class="flex items-center gap-2">
                            <i :class="[battle.icon, battle.textClass]"></i>
                            <h3 class="font-bold text-gray-800 m-0">{{ battle.title }}</h3>
                        </div>
                    </div>

                    <div class="p-5 flex-1 flex flex-col justify-between">
                        <div v-if="battle.data.length > 0" class="mb-4">
                            <div class="flex justify-between items-end mb-1">
                                <span class="text-xs font-bold text-yellow-600 bg-yellow-100 px-2 py-0.5 rounded-full">CHAMPION</span>
                                <span class="text-3xl font-black text-gray-800 leading-none">{{ battle.data[0].count.toLocaleString() }}</span>
                            </div>
                            <h4 class="text-xl font-bold text-blue-900 leading-tight m-0">{{ battle.data[0].model }}</h4>
                            <p class="text-xs text-gray-400 m-0 mt-1">{{ battle.data[0].brand }}</p>
                        </div>
                        <div v-else class="text-center py-8 text-gray-300">æœ¬æœˆç„¡è³‡æ–™</div>

                        <div v-if="battle.data.length > 1" class="border-t border-gray-100 pt-3 mt-2 space-y-2">
                            <div v-for="(car, idx) in battle.data.slice(1, 3)" :key="idx" class="flex justify-between items-center text-sm">
                                <div class="flex items-center gap-2 overflow-hidden">
                                    <span class="rank-badge" :class="idx === 0 ? 'bg-gray-400' : 'bg-orange-700'">{{ idx + 2 }}</span>
                                    <span class="font-medium text-gray-700 truncate">{{ car.model }}</span>
                                </div>
                                <span class="font-bold text-gray-600">{{ car.count.toLocaleString() }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 mt-8 overflow-hidden">
                <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
                    <h3 class="font-bold text-gray-700 m-0">ğŸ”¥ å…¨å¸‚å ´ç¸½æ’å Top 10</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full min-w-[600px]">
                        <thead class="bg-gray-50 text-xs text-gray-500 uppercase">
                            <tr>
                                <th class="px-6 py-3 text-center w-16">Rank</th>
                                <th class="px-6 py-3 text-left">Model</th>
                                <th class="px-6 py-3 text-center">Type</th>
                                <th class="px-6 py-3 text-right">Units</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            <tr v-for="(car, idx) in top10List" :key="idx" class="hover:bg-blue-50 transition">
                                <td class="px-6 py-4 text-center">
                                    <span class="rank-badge" :class="idx < 3 ? ['bg-yellow-400', 'bg-gray-400', 'bg-orange-700'][idx] : 'bg-gray-200 text-gray-500'">{{ idx + 1 }}</span>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="font-bold text-gray-800">{{ car.model }}</div>
                                    <div class="text-xs text-gray-400">{{ car.brand }} <span v-if="car.source" class="ml-1 px-1 rounded bg-gray-100 text-gray-500">{{ car.source === 'Domestic' ? 'åœ‹ç”¢' : 'é€²å£' }}</span></div>
                                </td>
                                <td class="px-6 py-4 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-bold inline-block" :class="getCategoryBadge(car.category)">{{ car.category }}</span>
                                </td>
                                <td class="px-6 py-4 text-right font-bold text-blue-600 text-lg">{{ car.count.toLocaleString() }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div v-if="currentView === 'ranking'" class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden min-h-[600px]">
            <div class="p-4 border-b border-gray-200 bg-gray-50 flex flex-col md:flex-row gap-4 justify-between">
                <div class="flex gap-2">
                    <select v-model="selectedMonth" class="bg-white border border-gray-300 text-sm rounded-lg p-2.5">
                        <option v-for="m in sortedMonths" :value="m">{{ formatMonth(m) }}</option>
                    </select>
                    <select v-model="filterCategory" class="bg-white border border-gray-300 text-sm rounded-lg p-2.5">
                        <option value="All">æ‰€æœ‰è»Šç¨®</option>
                        <option value="SUV">SUV ä¼‘æ—…</option>
                        <option value="Sedan">Sedan æˆ¿è»Š</option>
                        <option value="Hatchback">Hatch æ€èƒŒ</option>
                        <option value="MPV">MPV å»‚å¼</option>
                        <option value="EV">EV é›»å‹•è»Š</option>
                    </select>
                </div>
                <div class="relative w-full md:w-64">
                    <input v-model="searchQuery" type="text" placeholder="æœå°‹è»Šæ¬¾..." class="w-full pl-3 pr-4 py-2 border border-gray-300 rounded-lg text-sm">
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-500 min-w-[600px]">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                        <tr>
                            <th class="px-6 py-3 text-center">Rank</th>
                            <th class="px-6 py-3">Model</th>
                            <th class="px-6 py-3 text-center">Category</th>
                            <th class="px-6 py-3 text-right">Units</th>
                            <th class="px-6 py-3 text-center">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(car, idx) in filteredRanking" :key="idx" class="bg-white border-b hover:bg-gray-50">
                            <td class="px-6 py-4 text-center font-bold">{{ idx + 1 }}</td>
                            <td class="px-6 py-4">
                                <div class="font-bold text-gray-900 text-base">{{ car.model }}</div>
                                <div class="text-xs text-gray-500">{{ car.brand }}</div>
                            </td>
                            <td class="px-6 py-4 text-center"><span class="px-2 py-1 rounded text-xs font-bold" :class="getCategoryBadge(car.category)">{{ car.category }}</span></td>
                            <td class="px-6 py-4 text-right font-bold text-gray-800 text-base">{{ car.count.toLocaleString() }}</td>
                            <td class="px-6 py-4 text-center">
                                <button @click="showTrend(car.model)" class="text-blue-600 hover:bg-blue-50 border border-blue-200 px-3 py-1 rounded text-xs">è¶¨å‹¢</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div v-if="currentView === 'trend'" class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="mb-6 max-w-md mx-auto">
                <label class="block mb-2 text-sm font-medium text-gray-900">æŸ¥è©¢æ­·å²è¶¨å‹¢</label>
                <div class="relative">
                    <input v-model="trendSearch" type="text" placeholder="è¼¸å…¥è»Šå (ä¾‹å¦‚: Corolla Cross)..." class="w-full p-3 border border-gray-300 rounded-lg shadow-sm">
                    <div v-if="trendSuggestions.length > 0 && trendSearch" class="absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-60 overflow-y-auto">
                        <div v-for="model in trendSuggestions" @click="selectTrendModel(model)" class="px-4 py-2 hover:bg-blue-50 cursor-pointer text-sm">{{ model }}</div>
                    </div>
                </div>
            </div>
            <div v-if="chartDataAvailable" class="relative h-[400px] w-full"><canvas id="salesChart"></canvas></div>
            <div v-else class="text-center py-20 text-gray-400 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200"><p>è«‹æœå°‹ä¸¦é¸æ“‡è»Šæ¬¾</p></div>
        </div>

    </main>
</div>

<script>
    const { createApp } = Vue;

    // === 2024 & 2025 å®Œæ•´è³‡æ–™åº« ===
    const rawSalesData = [
        {"month": "2024-03", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 692, "category": "SUV"},
        {"month": "2024-03", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 594, "category": "Hatchback"},
        {"month": "2024-03", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1460, "category": "SUV"},
        {"month": "2024-03", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 459, "category": "MPV"},
        {"month": "2024-03", "brand": "LEXUS", "model": "Lexus NX", "count": 1079, "category": "SUV"},
        {"month": "2024-03", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 416, "category": "EV"},
        {"month": "2024-03", "brand": "MG", "model": "MG HS", "count": 1711, "category": "SUV"},
        {"month": "2024-03", "brand": "TESLA", "model": "Tesla Model Y", "count": 1337, "category": "EV"},
        {"month": "2024-03", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 890, "category": "Sedan"},
        {"month": "2024-03", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 2281, "category": "SUV"},
        {"month": "2024-03", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1573, "category": "SUV"},
        {"month": "2024-03", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1502, "category": "SUV"},
        {"month": "2024-04", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 572, "category": "SUV"},
        {"month": "2024-04", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 620, "category": "Hatchback"},
        {"month": "2024-04", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1062, "category": "SUV"},
        {"month": "2024-04", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 556, "category": "MPV"},
        {"month": "2024-04", "brand": "LEXUS", "model": "Lexus NX", "count": 999, "category": "SUV"},
        {"month": "2024-04", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 1055, "category": "EV"},
        {"month": "2024-04", "brand": "MG", "model": "MG HS", "count": 1627, "category": "SUV"},
        {"month": "2024-04", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 954, "category": "Sedan"},
        {"month": "2024-04", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 2268, "category": "SUV"},
        {"month": "2024-04", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1569, "category": "SUV"},
        {"month": "2024-04", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1418, "category": "SUV"},
        {"month": "2024-05", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 602, "category": "SUV"},
        {"month": "2024-05", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 649, "category": "Hatchback"},
        {"month": "2024-05", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1378, "category": "SUV"},
        {"month": "2024-05", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 463, "category": "MPV"},
        {"month": "2024-05", "brand": "LEXUS", "model": "Lexus NX", "count": 696, "category": "SUV"},
        {"month": "2024-05", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 1100, "category": "EV"},
        {"month": "2024-05", "brand": "MG", "model": "MG HS", "count": 1283, "category": "SUV"},
        {"month": "2024-05", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 951, "category": "Sedan"},
        {"month": "2024-05", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 2347, "category": "SUV"},
        {"month": "2024-05", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1780, "category": "SUV"},
        {"month": "2024-05", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1378, "category": "SUV"},
        {"month": "2025-08", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 526, "category": "SUV"},
        {"month": "2025-08", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 286, "category": "Hatchback"},
        {"month": "2025-08", "brand": "ç¦ç‰¹", "model": "Ford Kuga", "count": 249, "category": "SUV"},
        {"month": "2025-08", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 978, "category": "SUV"},
        {"month": "2025-08", "brand": "å°æœ¬", "model": "Honda Fit", "count": 182, "category": "Hatchback"},
        {"month": "2025-08", "brand": "å°æœ¬", "model": "Honda HR-V", "count": 353, "category": "SUV"},
        {"month": "2025-08", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 313, "category": "MPV"},
        {"month": "2025-08", "brand": "ä¸‰é™½", "model": "Hyundai Tucson L", "count": 559, "category": "SUV"},
        {"month": "2025-08", "brand": "LEXUS", "model": "Lexus NX", "count": 668, "category": "SUV"},
        {"month": "2025-08", "brand": "LEXUS", "model": "Lexus RX", "count": 328, "category": "SUV"},
        {"month": "2025-08", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 413, "category": "EV"},
        {"month": "2025-08", "brand": "BENZ", "model": "M-Benz GLC", "count": 686, "category": "SUV"},
        {"month": "2025-08", "brand": "MG", "model": "MG HS", "count": 482, "category": "SUV"},
        {"month": "2025-08", "brand": "MG", "model": "MG ZS", "count": 178, "category": "SUV"},
        {"month": "2025-08", "brand": "è£•éš†", "model": "Nissan Kicks", "count": 331, "category": "SUV"},
        {"month": "2025-08", "brand": "è£•éš†", "model": "Nissan Sentra", "count": 195, "category": "Sedan"},
        {"month": "2025-08", "brand": "è£•éš†", "model": "Nissan X-Trail", "count": 395, "category": "SUV"},
        {"month": "2025-08", "brand": "TESLA", "model": "Tesla Model 3", "count": 685, "category": "EV"},
        {"month": "2025-08", "brand": "TESLA", "model": "Tesla Model Y", "count": 765, "category": "EV"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 789, "category": "Sedan"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 1903, "category": "SUV"},
        {"month": "2025-08", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1285, "category": "SUV"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Town Ace", "count": 1914, "category": "Other"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Vios", "count": 318, "category": "Sedan"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1115, "category": "SUV"},
        {"month": "2025-09", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 558, "category": "SUV"},
        {"month": "2025-09", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 348, "category": "Hatchback"},
        {"month": "2025-09", "brand": "ç¦ç‰¹", "model": "Ford Kuga", "count": 273, "category": "SUV"},
        {"month": "2025-09", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1052, "category": "SUV"},
        {"month": "2025-09", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 382, "category": "MPV"},
        {"month": "2025-09", "brand": "ä¸‰é™½", "model": "Hyundai Tucson L", "count": 612, "category": "SUV"},
        {"month": "2025-09", "brand": "LEXUS", "model": "Lexus NX", "count": 847, "category": "SUV"},
        {"month": "2025-09", "brand": "LEXUS", "model": "Lexus RX", "count": 462, "category": "SUV"},
        {"month": "2025-09", "brand": "LEXUS", "model": "Lexus UX", "count": 321, "category": "SUV"},
        {"month": "2025-09", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 594, "category": "EV"},
        {"month": "2025-09", "brand": "BENZ", "model": "M-Benz GLC", "count": 732, "category": "SUV"},
        {"month": "2025-09", "brand": "MG", "model": "MG HS", "count": 243, "category": "SUV"},
        {"month": "2025-09", "brand": "MG", "model": "MG ZS", "count": 110, "category": "SUV"},
        {"month": "2025-09", "brand": "è£•éš†", "model": "Nissan Kicks", "count": 482, "category": "SUV"},
        {"month": "2025-09", "brand": "è£•éš†", "model": "Nissan Sentra", "count": 352, "category": "Sedan"},
        {"month": "2025-09", "brand": "è£•éš†", "model": "Nissan X-Trail", "count": 521, "category": "SUV"},
        {"month": "2025-09", "brand": "TESLA", "model": "Tesla Model 3", "count": 921, "category": "EV"},
        {"month": "2025-09", "brand": "TESLA", "model": "Tesla Model Y", "count": 1135, "category": "EV"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 1082, "category": "Sedan"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 1949, "category": "SUV"},
        {"month": "2025-09", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1669, "category": "SUV"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Town Ace", "count": 2105, "category": "Other"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1412, "category": "SUV"},
        {"month": "2025-10", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 612, "category": "SUV"},
        {"month": "2025-10", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 402, "category": "Hatchback"},
        {"month": "2025-10", "brand": "ç¦ç‰¹", "model": "Ford Kuga", "count": 421, "category": "SUV"},
        {"month": "2025-10", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1152, "category": "SUV"},
        {"month": "2025-10", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 425, "category": "MPV"},
        {"month": "2025-10", "brand": "ä¸‰é™½", "model": "Hyundai Tucson L", "count": 685, "category": "SUV"},
        {"month": "2025-10", "brand": "LEXUS", "model": "Lexus NX", "count": 952, "category": "SUV"},
        {"month": "2025-10", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 382, "category": "EV"},
        {"month": "2025-10", "brand": "BENZ", "model": "M-Benz GLC", "count": 621, "category": "SUV"},
        {"month": "2025-10", "brand": "MG", "model": "MG HS", "count": 182, "category": "SUV"},
        {"month": "2025-10", "brand": "è£•éš†", "model": "Nissan X-Trail", "count": 550, "category": "SUV"},
        {"month": "2025-10", "brand": "TESLA", "model": "Tesla Model Y", "count": 821, "category": "EV"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 982, "category": "Sedan"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 3476, "category": "SUV"},
        {"month": "2025-10", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1592, "category": "SUV"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Town Ace", "count": 2056, "category": "Other"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1285, "category": "SUV"}
    ];

    createApp({
        data() {
            return {
                currentView: 'dashboard',
                selectedMonth: '2025-10',
                filterCategory: 'All',
                searchQuery: '',
                trendSearch: '',
                salesData: [],
                chartInstance: null,
                battlefields: []
            }
        },
        created() {
            // è‡ªå‹•æ¨™è¨˜åœ‹ç”¢/é€²å£ (Source Mapping)
            this.salesData = rawSalesData.map(d => ({
                ...d,
                source: this.getCarSource(d.brand, d.model)
            }));
            this.updateBattlefields();
        },
        computed: {
            sortedMonths() {
                const months = [...new Set(this.salesData.map(d => d.month))];
                return months.sort().reverse();
            },
            currentMonthData() {
                return this.salesData.filter(d => d.month === this.selectedMonth);
            },
            top10List() {
                return this.currentMonthData
                    .filter(d => d.category !== 'Other') // æ’é™¤å•†ç”¨è»Š (Town Ace) é¿å…æ´—ç‰ˆ
                    .sort((a, b) => b.count - a.count)
                    .slice(0, 10);
            },
            filteredRanking() {
                let data = this.currentMonthData;
                if (this.filterCategory !== 'All') data = data.filter(d => d.category === this.filterCategory);
                if (this.searchQuery) {
                    const q = this.searchQuery.toLowerCase();
                    data = data.filter(d => d.model.toLowerCase().includes(q) || d.brand.toLowerCase().includes(q));
                }
                return data.sort((a, b) => b.count - a.count);
            },
            trendSuggestions() {
                if (!this.trendSearch) return [];
                const q = this.trendSearch.toLowerCase();
                const allModels = [...new Set(this.salesData.map(d => d.model))];
                return allModels.filter(m => m.toLowerCase().includes(q)).slice(0, 5);
            },
            chartDataAvailable() { return this.chartInstance !== null; }
        },
        watch: {
            selectedMonth() { this.updateBattlefields(); },
            currentView(newVal) {
                if (newVal === 'trend' && this.trendSearch) {
                    this.$nextTick(() => this.renderChart(this.trendSearch));
                }
            }
        },
        methods: {
            formatMonth(ym) {
                const [y, m] = ym.split('-');
                return `${y}å¹´ ${parseInt(m)}æœˆ`;
            },
            getCategoryBadge(cat) {
                const map = {
                    'SUV': 'bg-orange-100 text-orange-600',
                    'Sedan': 'bg-blue-100 text-blue-600',
                    'Hatchback': 'bg-yellow-100 text-yellow-600',
                    'MPV': 'bg-purple-100 text-purple-600',
                    'EV': 'bg-green-100 text-green-600',
                    'Other': 'bg-gray-100 text-gray-500'
                };
                return map[cat] || map['Other'];
            },
            // æ ¸å¿ƒé‚è¼¯ï¼šåˆ¤æ–·åœ‹ç”¢ vs é€²å£
            getCarSource(brand, model) {
                const domesticList = ['Nissan', 'Ford', 'Honda', 'Hyundai', 'Mitsubishi', 'ä¸­è¯CMC', 'ç´æ™ºæ·', 'Luxgen', 'MG', 'ä¸‰é™½', 'è£•éš†', 'å°æœ¬', 'åœ‹ç‘', 'ç¦ç‰¹'];
                const domesticModels = ['Corolla Cross', 'Altis', 'Yaris Cross', 'Vios', 'Sienta', 'Town Ace', 'Zinger'];
                
                // ç‰¹ä¾‹ï¼šToyota é€²å£è»Š
                if (brand.includes('Toyota') || brand.includes('TOYOTA')) {
                    if (domesticModels.some(m => model.includes(m))) return 'Domestic';
                    return 'Import'; // RAV4, Camry, etc.
                }
                
                if (domesticList.some(b => brand.includes(b))) return 'Domestic';
                return 'Import';
            },
            isLuxury(brand) {
                const luxury = ['Lexus', 'BENZ', 'M-Benz', 'BMW', 'Volvo', 'Tesla', 'Audi', 'Porsche', 'LEXUS'];
                return luxury.some(b => brand.includes(b));
            },
            // ç”¢ç”Ÿ 6 å¤§æˆ°å€æ•¸æ“š (Top 3)
            updateBattlefields() {
                const data = this.currentMonthData;
                
                const getTop3 = (filterFn) => {
                    return data.filter(filterFn).sort((a, b) => b.count - a.count).slice(0, 3);
                };

                this.battlefields = [
                    { 
                        title: 'åœ‹ç”¢ä¼‘æ—… Top 3', 
                        icon: 'fas fa-truck-monster', 
                        textClass: 'text-orange-600', bgLight: 'bg-orange-50',
                        data: getTop3(d => d.source === 'Domestic' && d.category === 'SUV')
                    },
                    { 
                        title: 'é€²å£ä¼‘æ—… Top 3', 
                        icon: 'fas fa-plane-arrival', 
                        textClass: 'text-blue-600', bgLight: 'bg-blue-50',
                        data: getTop3(d => d.source === 'Import' && d.category === 'SUV' && !this.isLuxury(d.brand))
                    },
                    { 
                        title: 'åœ‹ç”¢è½è»Š/æ€èƒŒ Top 3', 
                        icon: 'fas fa-car-side', 
                        textClass: 'text-green-600', bgLight: 'bg-green-50',
                        data: getTop3(d => d.source === 'Domestic' && (d.category === 'Sedan' || d.category === 'Hatchback'))
                    },
                    { 
                        title: 'é€²å£è½è»Š/æ€èƒŒ Top 3', 
                        icon: 'fas fa-car', 
                        textClass: 'text-teal-600', bgLight: 'bg-teal-50',
                        data: getTop3(d => d.source === 'Import' && (d.category === 'Sedan' || d.category === 'Hatchback') && !this.isLuxury(d.brand))
                    },
                    { 
                        title: 'è±ªè¯å“ç‰Œ Top 3', 
                        icon: 'fas fa-gem', 
                        textClass: 'text-purple-600', bgLight: 'bg-purple-50',
                        data: getTop3(d => this.isLuxury(d.brand))
                    },
                    { 
                        title: 'é›»å‹•è»Š Top 3', 
                        icon: 'fas fa-bolt', 
                        textClass: 'text-yellow-600', bgLight: 'bg-yellow-50',
                        data: getTop3(d => d.category === 'EV')
                    }
                ];
            },
            // ... (å…¶é¤˜åœ–è¡¨åŠŸèƒ½ä¿æŒä¸è®Š) ...
            showTrend(modelName) {
                this.currentView = 'trend';
                this.trendSearch = modelName;
                this.renderChart(modelName);
            },
            selectTrendModel(modelName) {
                this.trendSearch = modelName;
                this.renderChart(modelName);
            },
            renderChart(modelName) {
                const ctx = document.getElementById('salesChart');
                if (!ctx) return;
                const modelData = this.salesData.filter(d => d.model === modelName);
                const months = [...new Set(this.salesData.map(d => d.month))].sort();
                const counts = months.map(m => {
                    const record = modelData.find(d => d.month === m);
                    return record ? record.count : 0;
                });
                if (this.chartInstance) this.chartInstance.destroy();
                this.chartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [{
                            label: modelName + ' éŠ·å”®è¶¨å‹¢',
                            data: counts,
                            borderColor: 'rgb(37, 99, 235)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.3
                        }]
                    },
                    options: { responsive: true, maintainAspectRatio: false }
                });
            }
        }
    }).mount('#car-sales-app');
</script>

</body>
</html>
