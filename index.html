<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‡¹ğŸ‡¼ å°ç£è»Šæ¬¾éŠ·å”®æŸ¥è©¢å°å¹«æ‰‹</title>
    
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%232563EB'%3E%3Cpath d='M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z'/%3E%3C/svg%3E">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            corePlugins: {
                preflight: false, 
            }
        }
    </script>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        
        /* ç¢ºä¿å·¥å…·å…§çš„å­—é«”æ­£ç¢º */
        #car-sales-app { 
            font-family: 'Noto Sans TC', sans-serif; 
            line-height: 1.5;
        }
        
        /* v-cloak: åœ¨ Vue è¼‰å…¥å®Œæˆå‰éš±è—å…§å®¹ */
        [v-cloak] { display: none; }
        
        /* ç°¡å–®çš„æ·¡å…¥å‹•ç•« */
        .fade-enter-active, .fade-leave-active { transition: opacity 0.3s ease; }
        .fade-enter-from, .fade-leave-to { opacity: 0; }

        /* ä¿®æ­£ WordPress å¯èƒ½é€ æˆçš„æ¨£å¼è¡çª */
        #car-sales-app button { border-style: solid; cursor: pointer; }
        #car-sales-app input, #car-sales-app select { border-style: solid; }
        #car-sales-app table { border-collapse: collapse; }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

<div id="car-sales-app" v-cloak class="max-w-6xl mx-auto min-h-screen flex flex-col bg-gray-50">
    
    <header class="bg-white shadow-sm sticky top-0 z-20 border-b border-gray-200">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 text-white p-2 rounded-lg flex items-center justify-center w-10 h-10">
                    <i class="fas fa-car-side text-xl"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-gray-900 leading-tight m-0">å°ç£è»Šæ¬¾éŠ·å”®å°å¹«æ‰‹</h1>
                    <p class="text-xs text-gray-500 m-0">è³‡æ–™ä¾†æºï¼šç›£ç†æ‰€é ˜ç‰Œæ˜ç´°</p>
                </div>
            </div>
            
            <div class="flex bg-gray-100 p-1 rounded-lg">
                <button @click="currentView = 'dashboard'" :class="{'bg-white shadow text-blue-600': currentView === 'dashboard', 'text-gray-600 hover:bg-gray-200': currentView !== 'dashboard'}" class="px-4 py-2 rounded-md text-sm font-bold transition border-0">
                    <i class="fas fa-trophy mr-1"></i> æˆ°æ³
                </button>
                <button @click="currentView = 'ranking'" :class="{'bg-white shadow text-blue-600': currentView === 'ranking', 'text-gray-600 hover:bg-gray-200': currentView !== 'ranking'}" class="px-4 py-2 rounded-md text-sm font-bold transition border-0">
                    <i class="fas fa-list-ol mr-1"></i> æ¦œå–®
                </button>
                <button @click="currentView = 'trend'" :class="{'bg-white shadow text-blue-600': currentView === 'trend', 'text-gray-600 hover:bg-gray-200': currentView !== 'trend'}" class="px-4 py-2 rounded-md text-sm font-bold transition border-0">
                    <i class="fas fa-chart-line mr-1"></i> è¶¨å‹¢
                </button>
            </div>
        </div>
    </header>

    <main class="flex-1 container mx-auto px-4 py-6">
        
        <div v-if="currentView === 'dashboard'" class="space-y-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 m-0">ğŸ† æœ¬æœˆå„ç´šè·éŠ·å”®å† è»</h2>
                <div class="relative inline-block">
                    <select v-model="selectedMonth" class="appearance-none bg-white border border-gray-300 px-4 py-2 pr-8 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 font-bold text-gray-700 cursor-pointer">
                        <option v-for="m in sortedMonths" :value="m">{{ formatMonth(m) }}</option>
                    </select>
                    <i class="fas fa-chevron-down absolute right-3 top-3 text-gray-400 pointer-events-none"></i>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div v-for="cat in categories" :key="cat.key" class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition">
                    <div :class="cat.bgClass" class="h-2"></div>
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center gap-2">
                                <div :class="[cat.bgClass, cat.textClass]" class="bg-opacity-20 w-8 h-8 rounded-full flex items-center justify-center">
                                    <i :class="cat.icon"></i>
                                </div>
                                <span class="text-sm font-bold text-gray-500 uppercase tracking-wider">{{ cat.label }}</span>
                            </div>
                            <span v-if="getChampion(cat.key)" class="text-2xl font-black text-gray-800">{{ getChampion(cat.key).count.toLocaleString() }}</span>
                        </div>
                        
                        <div v-if="getChampion(cat.key)">
                            <h3 class="text-lg font-bold text-gray-900 mb-1 truncate m-0">{{ getChampion(cat.key).model }}</h3>
                            <p class="text-xs text-gray-400 m-0">{{ getChampion(cat.key).brand }}</p>
                        </div>
                        <div v-else class="text-center py-4 text-gray-300">
                            ç„¡è³‡æ–™
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 mt-8 overflow-hidden">
                <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
                    <h3 class="font-bold text-gray-700 m-0">ğŸ”¥ æœ¬æœˆç¸½æ’å Top 10</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full min-w-[600px]">
                        <thead class="bg-gray-50 text-xs text-gray-500 uppercase">
                            <tr>
                                <th class="px-6 py-3 text-center w-16">æ’å</th>
                                <th class="px-6 py-3 text-left">è»Šæ¬¾</th>
                                <th class="px-6 py-3 text-center">é¡åˆ¥</th>
                                <th class="px-6 py-3 text-right">éŠ·é‡</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-100">
                            <tr v-for="(car, idx) in top10List" :key="idx" class="hover:bg-blue-50 transition">
                                <td class="px-6 py-4 text-center">
                                    <span class="w-6 h-6 inline-flex items-center justify-center rounded-full text-xs font-bold"
                                          :class="{'bg-yellow-400 text-white': idx===0, 'bg-gray-300 text-white': idx===1, 'bg-orange-400 text-white': idx===2, 'text-gray-500': idx>2}">
                                        {{ idx + 1 }}
                                    </span>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="font-bold text-gray-800">{{ car.model }}</div>
                                    <div class="text-xs text-gray-400">{{ car.brand }}</div>
                                </td>
                                <td class="px-6 py-4 text-center">
                                    <span class="px-2 py-1 rounded text-xs font-bold inline-block" :class="getCategoryBadge(car.category)">
                                        {{ car.category }}
                                    </span>
                                </td>
                                <td class="px-6 py-4 text-right font-bold text-blue-600 text-lg">
                                    {{ car.count.toLocaleString() }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div v-if="currentView === 'ranking'" class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden min-h-[600px]">
            <div class="p-4 border-b border-gray-200 bg-gray-50 flex flex-col md:flex-row gap-4 justify-between">
                <div class="flex gap-2">
                    <select v-model="selectedMonth" class="bg-white border border-gray-300 text-sm rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500">
                        <option v-for="m in sortedMonths" :value="m">{{ formatMonth(m) }}</option>
                    </select>
                    <select v-model="filterCategory" class="bg-white border border-gray-300 text-sm rounded-lg p-2.5 focus:ring-blue-500 focus:border-blue-500">
                        <option value="All">å…¨éƒ¨åˆ†é¡</option>
                        <option value="SUV">SUV ä¼‘æ—…</option>
                        <option value="Sedan">Sedan æˆ¿è»Š</option>
                        <option value="Hatchback">Hatch æ€èƒŒ</option>
                        <option value="MPV">MPV å»‚å¼</option>
                        <option value="EV">EV é›»å‹•è»Š</option>
                    </select>
                </div>
                <div class="relative w-full md:w-64">
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                    <input v-model="searchQuery" type="text" placeholder="æœå°‹è»Šæ¬¾..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                </div>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-500 min-w-[600px]">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                        <tr>
                            <th scope="col" class="px-6 py-3 w-16 text-center">Rank</th>
                            <th scope="col" class="px-6 py-3">Brand / Model</th>
                            <th scope="col" class="px-6 py-3 text-center">Category</th>
                            <th scope="col" class="px-6 py-3 text-right">Units</th>
                            <th scope="col" class="px-6 py-3 text-center">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(car, idx) in filteredRanking" :key="idx" class="bg-white border-b hover:bg-gray-50">
                            <td class="px-6 py-4 font-medium text-gray-900 text-center">{{ idx + 1 }}</td>
                            <td class="px-6 py-4">
                                <div class="font-bold text-gray-900 text-base">{{ car.model }}</div>
                                <div class="text-xs text-gray-500">{{ car.brand }}</div>
                            </td>
                            <td class="px-6 py-4 text-center">
                                <span class="px-2 py-1 rounded text-xs font-bold inline-block" :class="getCategoryBadge(car.category)">
                                    {{ car.category }}
                                </span>
                            </td>
                            <td class="px-6 py-4 text-right font-bold text-gray-800 text-base">
                                {{ car.count.toLocaleString() }}
                            </td>
                            <td class="px-6 py-4 text-center">
                                <button @click="showTrend(car.model)" class="text-blue-600 hover:text-blue-900 font-medium text-xs border border-blue-200 px-3 py-1 rounded hover:bg-blue-50">
                                    <i class="fas fa-chart-line"></i> è¶¨å‹¢
                                </button>
                            </td>
                        </tr>
                        <tr v-if="filteredRanking.length === 0">
                            <td colspan="5" class="px-6 py-8 text-center text-gray-400">
                                ç„¡ç¬¦åˆè³‡æ–™
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div v-if="currentView === 'trend'" class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <div class="mb-6 max-w-md mx-auto">
                <label class="block mb-2 text-sm font-medium text-gray-900">é¸æ“‡è»Šæ¬¾æŸ¥è©¢æ­·å²è¶¨å‹¢</label>
                <div class="relative">
                    <input v-model="trendSearch" type="text" placeholder="è¼¸å…¥è»Šå (ä¾‹å¦‚: Corolla Cross)..." 
                           class="w-full p-3 pl-10 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    <i class="fas fa-search absolute left-3 top-3.5 text-gray-400"></i>
                    
                    <div v-if="trendSuggestions.length > 0 && trendSearch" class="absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-60 overflow-y-auto">
                        <div v-for="model in trendSuggestions" @click="selectTrendModel(model)" class="px-4 py-2 hover:bg-blue-50 cursor-pointer text-sm">
                            {{ model }}
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="chartDataAvailable" class="relative h-[400px] w-full">
                <canvas id="salesChart"></canvas>
            </div>
            <div v-else class="text-center py-20 text-gray-400 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200">
                <i class="fas fa-search text-4xl mb-3 text-gray-300"></i>
                <p>è«‹æœå°‹ä¸¦é¸æ“‡ä¸€æ¬¾è»Šå‹ä»¥æŸ¥çœ‹éŠ·å”®æ›²ç·š</p>
            </div>
        </div>

    </main>
</div>

<script>
    const { createApp } = Vue;

    // === è³‡æ–™åº« (å« 2024 ä¸ŠåŠå¹´ & 2025 ä¸‹åŠå¹´) ===
    const rawSalesData = [
        // --- 2024 DATA ---
        {"month": "2024-03", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 692, "category": "SUV"},
        {"month": "2024-03", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 594, "category": "Hatchback"},
        {"month": "2024-03", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1460, "category": "SUV"},
        {"month": "2024-03", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 459, "category": "MPV"},
        {"month": "2024-03", "brand": "LEXUS", "model": "Lexus NX", "count": 1079, "category": "SUV"},
        {"month": "2024-03", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 416, "category": "EV"},
        {"month": "2024-03", "brand": "MG", "model": "MG HS", "count": 1711, "category": "SUV"},
        {"month": "2024-03", "brand": "TESLA", "model": "Tesla Model Y", "count": 1337, "category": "EV"},
        {"month": "2024-03", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 890, "category": "Sedan"},
        {"month": "2024-03", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 2281, "category": "SUV"},
        {"month": "2024-03", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1573, "category": "SUV"},
        {"month": "2024-03", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1502, "category": "SUV"},
        {"month": "2024-04", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 572, "category": "SUV"},
        {"month": "2024-04", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 620, "category": "Hatchback"},
        {"month": "2024-04", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1062, "category": "SUV"},
        {"month": "2024-04", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 556, "category": "MPV"},
        {"month": "2024-04", "brand": "LEXUS", "model": "Lexus NX", "count": 999, "category": "SUV"},
        {"month": "2024-04", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 1055, "category": "EV"},
        {"month": "2024-04", "brand": "MG", "model": "MG HS", "count": 1627, "category": "SUV"},
        {"month": "2024-04", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 954, "category": "Sedan"},
        {"month": "2024-04", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 2268, "category": "SUV"},
        {"month": "2024-04", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1569, "category": "SUV"},
        {"month": "2024-04", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1418, "category": "SUV"},
        {"month": "2024-05", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 602, "category": "SUV"},
        {"month": "2024-05", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 649, "category": "Hatchback"},
        {"month": "2024-05", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1378, "category": "SUV"},
        {"month": "2024-05", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 463, "category": "MPV"},
        {"month": "2024-05", "brand": "LEXUS", "model": "Lexus NX", "count": 696, "category": "SUV"},
        {"month": "2024-05", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 1100, "category": "EV"},
        {"month": "2024-05", "brand": "MG", "model": "MG HS", "count": 1283, "category": "SUV"},
        {"month": "2024-05", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 951, "category": "Sedan"},
        {"month": "2024-05", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 2347, "category": "SUV"},
        {"month": "2024-05", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1780, "category": "SUV"},
        {"month": "2024-05", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1378, "category": "SUV"},

        // --- 2025-08 ---
        {"month": "2025-08", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 526, "category": "SUV"},
        {"month": "2025-08", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 286, "category": "Hatchback"},
        {"month": "2025-08", "brand": "ç¦ç‰¹", "model": "Ford Kuga", "count": 249, "category": "SUV"},
        {"month": "2025-08", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 978, "category": "SUV"},
        {"month": "2025-08", "brand": "å°æœ¬", "model": "Honda Fit", "count": 182, "category": "Hatchback"},
        {"month": "2025-08", "brand": "å°æœ¬", "model": "Honda HR-V", "count": 353, "category": "SUV"},
        {"month": "2025-08", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 313, "category": "MPV"},
        {"month": "2025-08", "brand": "ä¸‰é™½", "model": "Hyundai Tucson L", "count": 559, "category": "SUV"},
        {"month": "2025-08", "brand": "LEXUS", "model": "Lexus NX", "count": 668, "category": "SUV"},
        {"month": "2025-08", "brand": "LEXUS", "model": "Lexus RX", "count": 328, "category": "SUV"},
        {"month": "2025-08", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 413, "category": "EV"},
        {"month": "2025-08", "brand": "BENZ", "model": "M-Benz GLC", "count": 686, "category": "SUV"},
        {"month": "2025-08", "brand": "MG", "model": "MG HS", "count": 482, "category": "SUV"},
        {"month": "2025-08", "brand": "MG", "model": "MG ZS", "count": 178, "category": "SUV"},
        {"month": "2025-08", "brand": "è£•éš†", "model": "Nissan Kicks", "count": 331, "category": "SUV"},
        {"month": "2025-08", "brand": "è£•éš†", "model": "Nissan Sentra", "count": 195, "category": "Sedan"},
        {"month": "2025-08", "brand": "è£•éš†", "model": "Nissan X-Trail", "count": 395, "category": "SUV"},
        {"month": "2025-08", "brand": "TESLA", "model": "Tesla Model 3", "count": 685, "category": "EV"},
        {"month": "2025-08", "brand": "TESLA", "model": "Tesla Model Y", "count": 765, "category": "EV"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 789, "category": "Sedan"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 1903, "category": "SUV"},
        {"month": "2025-08", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1285, "category": "SUV"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Town Ace", "count": 1914, "category": "Other"},
        {"month": "2025-08", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1115, "category": "SUV"},

        // --- 2025-09 ---
        {"month": "2025-09", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 558, "category": "SUV"},
        {"month": "2025-09", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 348, "category": "Hatchback"},
        {"month": "2025-09", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1052, "category": "SUV"},
        {"month": "2025-09", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 382, "category": "MPV"},
        {"month": "2025-09", "brand": "ä¸‰é™½", "model": "Hyundai Tucson L", "count": 612, "category": "SUV"},
        {"month": "2025-09", "brand": "LEXUS", "model": "Lexus NX", "count": 847, "category": "SUV"},
        {"month": "2025-09", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 594, "category": "EV"},
        {"month": "2025-09", "brand": "BENZ", "model": "M-Benz GLC", "count": 732, "category": "SUV"},
        {"month": "2025-09", "brand": "MG", "model": "MG HS", "count": 243, "category": "SUV"},
        {"month": "2025-09", "brand": "è£•éš†", "model": "Nissan Kicks", "count": 482, "category": "SUV"},
        {"month": "2025-09", "brand": "è£•éš†", "model": "Nissan X-Trail", "count": 521, "category": "SUV"},
        {"month": "2025-09", "brand": "TESLA", "model": "Tesla Model 3", "count": 921, "category": "EV"},
        {"month": "2025-09", "brand": "TESLA", "model": "Tesla Model Y", "count": 1135, "category": "EV"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 1082, "category": "Sedan"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 1949, "category": "SUV"},
        {"month": "2025-09", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1669, "category": "SUV"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Town Ace", "count": 2105, "category": "Other"},
        {"month": "2025-09", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1412, "category": "SUV"},

        // --- 2025-10 ---
        {"month": "2025-10", "brand": "ä¸­è¯CMC", "model": "CMC Zinger", "count": 612, "category": "SUV"},
        {"month": "2025-10", "brand": "ç¦ç‰¹", "model": "Ford Focus", "count": 402, "category": "Hatchback"},
        {"month": "2025-10", "brand": "ç¦ç‰¹", "model": "Ford Kuga", "count": 421, "category": "SUV"},
        {"month": "2025-10", "brand": "å°æœ¬", "model": "Honda CR-V", "count": 1152, "category": "SUV"},
        {"month": "2025-10", "brand": "ä¸‰é™½", "model": "Hyundai Custin", "count": 425, "category": "MPV"},
        {"month": "2025-10", "brand": "ä¸‰é™½", "model": "Hyundai Tucson L", "count": 685, "category": "SUV"},
        {"month": "2025-10", "brand": "LEXUS", "model": "Lexus NX", "count": 952, "category": "SUV"},
        {"month": "2025-10", "brand": "ç´æ™ºæ·", "model": "Luxgen n7", "count": 382, "category": "EV"},
        {"month": "2025-10", "brand": "BENZ", "model": "M-Benz GLC", "count": 621, "category": "SUV"},
        {"month": "2025-10", "brand": "MG", "model": "MG HS", "count": 182, "category": "SUV"},
        {"month": "2025-10", "brand": "è£•éš†", "model": "Nissan X-Trail", "count": 550, "category": "SUV"},
        {"month": "2025-10", "brand": "TESLA", "model": "Tesla Model Y", "count": 821, "category": "EV"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Altis", "count": 982, "category": "Sedan"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Corolla Cross", "count": 3476, "category": "SUV"},
        {"month": "2025-10", "brand": "TOYOTA", "model": "Toyota RAV4", "count": 1592, "category": "SUV"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Town Ace", "count": 2056, "category": "Other"},
        {"month": "2025-10", "brand": "åœ‹ç‘", "model": "Toyota Yaris Cross", "count": 1285, "category": "SUV"}
    ];

    createApp({
        data() {
            return {
                currentView: 'dashboard',
                selectedMonth: '2025-10', // é è¨­é¡¯ç¤ºæœ€æ–°çš„ 2025-10
                filterCategory: 'All',
                searchQuery: '',
                trendSearch: '',
                salesData: rawSalesData,
                chartInstance: null,
                categories: [
                    { key: 'SUV', label: 'SUV ä¼‘æ—…', icon: 'fas fa-truck-monster', bgClass: 'bg-orange-500', textClass: 'text-orange-600' },
                    { key: 'Sedan', label: 'Sedan æˆ¿è»Š', icon: 'fas fa-car-side', bgClass: 'bg-blue-500', textClass: 'text-blue-600' },
                    { key: 'Hatchback', label: 'Hatch æ€èƒŒ', icon: 'fas fa-car', bgClass: 'bg-yellow-500', textClass: 'text-yellow-600' },
                    { key: 'MPV', label: 'MPV å»‚å¼', icon: 'fas fa-shuttle-van', bgClass: 'bg-purple-500', textClass: 'text-purple-600' },
                    { key: 'EV', label: 'EV é›»å‹•è»Š', icon: 'fas fa-bolt', bgClass: 'bg-green-500', textClass: 'text-green-600' },
                ]
            }
        },
        computed: {
            sortedMonths() {
                // æŠ“å‡ºæ‰€æœ‰æœˆä»½ä¸¦å€’åºæ’åˆ—
                const months = [...new Set(this.salesData.map(d => d.month))];
                return months.sort().reverse();
            },
            currentMonthData() {
                return this.salesData.filter(d => d.month === this.selectedMonth);
            },
            // æˆ°æ³çœ‹æ¿ï¼šæ‰¾å‡ºå„åˆ†é¡çš„ç¬¬ä¸€å
            categoryChampions() {
                const champs = {};
                this.categories.forEach(cat => {
                    const filtered = this.currentMonthData
                        .filter(d => d.category === cat.key)
                        .sort((a, b) => b.count - a.count);
                    champs[cat.key] = filtered.length > 0 ? filtered[0] : null;
                });
                return champs;
            },
            // æˆ°æ³çœ‹æ¿ï¼šTop 10 ç¸½æ’å
            top10List() {
                return this.currentMonthData
                    .sort((a, b) => b.count - a.count)
                    .slice(0, 10);
            },
            // æ¦œå–®é é¢ï¼šç¯©é¸èˆ‡æœå°‹
            filteredRanking() {
                let data = this.currentMonthData;
                
                // åˆ†é¡ç¯©é¸
                if (this.filterCategory !== 'All') {
                    data = data.filter(d => d.category === this.filterCategory);
                }
                
                // æœå°‹æ–‡å­—
                if (this.searchQuery) {
                    const q = this.searchQuery.toLowerCase();
                    data = data.filter(d => d.model.toLowerCase().includes(q) || d.brand.toLowerCase().includes(q));
                }
                
                return data.sort((a, b) => b.count - a.count);
            },
            // è¶¨å‹¢æœå°‹å»ºè­°
            trendSuggestions() {
                if (!this.trendSearch) return [];
                const q = this.trendSearch.toLowerCase();
                const allModels = [...new Set(this.salesData.map(d => d.model))];
                return allModels.filter(m => m.toLowerCase().includes(q)).slice(0, 5);
            },
            chartDataAvailable() {
                return this.chartInstance !== null;
            }
        },
        methods: {
            formatMonth(ym) {
                const [y, m] = ym.split('-');
                return `${y}å¹´ ${parseInt(m)}æœˆ`;
            },
            getCategoryBadge(cat) {
                const map = {
                    'SUV': 'bg-orange-100 text-orange-600',
                    'Sedan': 'bg-blue-100 text-blue-600',
                    'Hatchback': 'bg-yellow-100 text-yellow-600',
                    'MPV': 'bg-purple-100 text-purple-600',
                    'EV': 'bg-green-100 text-green-600',
                    'Other': 'bg-gray-100 text-gray-500'
                };
                return map[cat] || map['Other'];
            },
            getChampion(catKey) {
                return this.categoryChampions[catKey];
            },
            // åˆ‡æ›åˆ°è¶¨å‹¢åœ–
            showTrend(modelName) {
                this.currentView = 'trend';
                this.trendSearch = modelName;
                this.renderChart(modelName);
            },
            selectTrendModel(modelName) {
                this.trendSearch = modelName;
                this.renderChart(modelName);
            },
            renderChart(modelName) {
                const ctx = document.getElementById('salesChart');
                if (!ctx) return; // å¦‚æœæ²’åˆ‡åˆ°è©²åˆ†é å°±è·³å‡º

                // æŠ“å–è©²è»Šå‹æ‰€æœ‰æœˆä»½æ•¸æ“š
                const modelData = this.salesData.filter(d => d.model === modelName);
                // æ•´ç†æœˆä»½è»¸
                const months = [...new Set(this.salesData.map(d => d.month))].sort();
                
                const counts = months.map(m => {
                    const record = modelData.find(d => d.month === m);
                    return record ? record.count : 0;
                });

                if (this.chartInstance) {
                    this.chartInstance.destroy();
                }

                this.chartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [{
                            label: modelName + ' éŠ·å”®è¶¨å‹¢',
                            data: counts,
                            borderColor: 'rgb(37, 99, 235)',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' }
                        },
                        scales: {
                            y: { beginAtZero: true }
                        }
                    }
                });
            }
        },
        // ç›£è½åˆ†é åˆ‡æ›ï¼Œå¦‚æœæ˜¯è¶¨å‹¢åœ–ä¸”å·²æœ‰æœå°‹å­—ï¼Œå°±é‡ç¹ªåœ–è¡¨
        watch: {
            currentView(newVal) {
                if (newVal === 'trend' && this.trendSearch) {
                    this.$nextTick(() => {
                        this.renderChart(this.trendSearch);
                    });
                }
            }
        }
    }).mount('#car-sales-app');
</script>

</body>
</html>
